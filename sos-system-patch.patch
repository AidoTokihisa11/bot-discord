From 53e82f3213710386834605a70fc81b059c6f07ac Mon Sep 17 00:00:00 2001
From: AidoTokihisa <theo.garces@coda-student.school>
Date: Fri, 1 Aug 2025 15:15:24 +0200
Subject: [PATCH] SOS message

---
 src/managers/TicketManager.js | 236 +++++++++++++++++++++++++++++++++-
 1 file changed, 232 insertions(+), 4 deletions(-)

diff --git a/src/managers/TicketManager.js b/src/managers/TicketManager.js
index fa840eb..20a88e1 100644
--- a/src/managers/TicketManager.js
+++ b/src/managers/TicketManager.js
@@ -233,10 +233,10 @@ Notre Ã©quipe d'experts est lÃ  pour vous aider rapidement et efficacement.
                         .setStyle(ButtonStyle.Secondary)
                         .setEmoji('ğŸ“‹'),
                     new ButtonBuilder()
-                        .setCustomId('ticket_contact_staff')
-                        .setLabel('Contact Direct')
-                        .setStyle(ButtonStyle.Secondary)
-                        .setEmoji('ğŸ“')
+                        .setCustomId('ticket_sos')
+                        .setLabel('SOS - Aide d\'Urgence')
+                        .setStyle(ButtonStyle.Danger)
+                        .setEmoji('ğŸ†˜')
                 );
 
             // Embed d'informations dÃ©taillÃ©es
@@ -859,6 +859,13 @@ ${description.substring(0, 500)}${description.length > 500 ? '...' : ''}
             case 'ticket_contact_staff':
                 await this.contactStaff(interaction);
                 break;
+            case 'ticket_sos':
+                await this.showSOSPanel(interaction);
+                break;
+            case 'sos_create_support_ticket':
+                // Rediriger vers la crÃ©ation d'un ticket de support spÃ©cialisÃ©
+                await this.handleTicketCreation(interaction, 'support');
+                break;
         }
     }
 
@@ -970,6 +977,227 @@ ${description.substring(0, 500)}${description.length > 500 ? '...' : ''}
         await this.safeInteractionReply(interaction, { embeds: [contactEmbed], flags: MessageFlags.Ephemeral });
     }
 
+    async showSOSPanel(interaction) {
+        try {
+            // Embed principal SOS avec design professionnel
+            const sosMainEmbed = new EmbedBuilder()
+                .setColor('#ff0000')
+                .setTitle('ğŸ†˜ **AIDE D\'URGENCE - PRÃ‰VENTION DU SUICIDE**')
+                .setDescription(`
+â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
+â”‚   **ğŸš¨ VOUS N'ÃŠTES PAS SEUL(E) ğŸš¨**   â”‚
+â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
+
+**Si vous traversez une pÃ©riode difficile, des professionnels sont lÃ  pour vous aider.**
+
+**âš¡ URGENCE IMMÃ‰DIATE :**
+â€¢ **SAMU :** \`15\` ğŸš‘
+â€¢ **Pompiers :** \`18\` ğŸš’
+â€¢ **Police :** \`17\` ğŸ‘®
+â€¢ **NumÃ©ro d'urgence europÃ©en :** \`112\` ğŸŒ
+
+**ğŸ¤ Vous avez de la valeur et votre vie compte.**`)
+                .setThumbnail('https://cdn.discordapp.com/emojis/1234567890123456789.png') // Vous pouvez ajouter une icÃ´ne
+                .setFooter({ 
+                    text: 'ğŸ’ Il y a toujours de l\'espoir â€¢ Vous mÃ©ritez d\'Ãªtre aidÃ©(e)',
+                    iconURL: interaction.client.user.displayAvatarURL()
+                })
+                .setTimestamp();
+
+            // Embed avec les numÃ©ros de prÃ©vention du suicide
+            const preventionEmbed = new EmbedBuilder()
+                .setColor('#ff6b6b')
+                .setTitle('ğŸ“ **LIGNES D\'Ã‰COUTE SPÃ‰CIALISÃ‰ES**')
+                .addFields(
+                    {
+                        name: 'ğŸ‡«ğŸ‡· **FRANCE - PrÃ©vention du Suicide**',
+                        value: `
+**ğŸ“ Suicide Ã‰coute :** \`01 45 39 40 00\`
+â€¢ **DisponibilitÃ© :** 24h/24, 7j/7
+â€¢ **Service :** Gratuit et anonyme
+â€¢ **Site web :** suicide-ecoute.fr
+
+**ğŸ“ SOS AmitiÃ© :** \`09 72 39 40 50\`
+â€¢ **DisponibilitÃ© :** 24h/24, 7j/7  
+â€¢ **Service :** Ã‰coute bienveillante
+â€¢ **Site web :** sos-amitie.org`,
+                        inline: false
+                    },
+                    {
+                        name: 'ğŸŒ **INTERNATIONAL**',
+                        value: `
+**ğŸ‡§ğŸ‡ª Belgique :** \`0800 32 123\` (24h/24)
+**ğŸ‡¨ğŸ‡­ Suisse :** \`143\` (24h/24)
+**ğŸ‡¨ğŸ‡¦ Canada :** \`1-833-456-4566\` (24h/24)
+**ğŸŒ International :** befrienders.org`,
+                        inline: true
+                    },
+                    {
+                        name: 'ğŸ‘¥ **JEUNES & Ã‰TUDIANTS**',
+                        value: `
+**ğŸ“ Fil SantÃ© Jeunes :** \`0800 235 236\`
+â€¢ **Ã‚ge :** 12-25 ans
+â€¢ **Horaires :** 9h-23h
+â€¢ **Chat :** filsantejeunes.com
+
+**ğŸ“ Nightline :** nightline.fr
+â€¢ **Service :** Par et pour les Ã©tudiants`,
+                        inline: true
+                    }
+                )
+                .setFooter({ text: 'Tous ces services sont confidentiels et gratuits' });
+
+            // Embed avec resources en ligne et conseils
+            const resourcesEmbed = new EmbedBuilder()
+                .setColor('#4CAF50')
+                .setTitle('ğŸ’» **RESSOURCES EN LIGNE & CONSEILS**')
+                .addFields(
+                    {
+                        name: 'ğŸŒ **Sites Web d\'Aide**',
+                        value: `
+â€¢ **stopblues.fr** - PrÃ©vention de la dÃ©pression chez les jeunes
+â€¢ **psycom.org** - Information en santÃ© mentale
+â€¢ **santementale.fr** - Ressources officielles
+â€¢ **tchat-suicide-ecoute.org** - Chat anonyme 24h/24`,
+                        inline: false
+                    },
+                    {
+                        name: 'ğŸ“± **Applications Mobiles**',
+                        value: `
+â€¢ **Mon Sherpa** - Accompagnement psychologique
+â€¢ **Mood Tools** - Outils contre la dÃ©pression
+â€¢ **Sanvello** - Gestion de l'anxiÃ©tÃ©
+â€¢ **Headspace** - MÃ©ditation et bien-Ãªtre`,
+                        inline: true
+                    },
+                    {
+                        name: 'ğŸ¥ **OÃ¹ Aller Physiquement**',
+                        value: `
+â€¢ **Urgences hospitaliÃ¨res** ğŸ¥
+â€¢ **Centres MÃ©dico-Psychologiques (CMP)**
+â€¢ **Maisons des Adolescents (MDA)**
+â€¢ **Points d'Accueil Ã‰coute Jeunes (PAEJ)**`,
+                        inline: true
+                    }
+                )
+                .setFooter({ text: 'N\'hÃ©sitez pas Ã  vous faire accompagner par un proche' });
+
+            // Embed avec signes d'alarme et conseils pour l'entourage
+            const supportEmbed = new EmbedBuilder()
+                .setColor('#9C27B0')
+                .setTitle('â¤ï¸ **POUR L\'ENTOURAGE & SIGNES D\'ALARME**')
+                .addFields(
+                    {
+                        name: 'ğŸš¨ **Signes Ã  Surveiller**',
+                        value: `
+â€¢ Changements soudains de comportement
+â€¢ Isolement social marquÃ©
+â€¢ Perte d'intÃ©rÃªt pour les activitÃ©s
+â€¢ Troubles du sommeil/appÃ©tit
+â€¢ Expressions de dÃ©sespoir
+â€¢ Don d'objets personnels`,
+                        inline: true
+                    },
+                    {
+                        name: 'ğŸ¤ **Comment Aider**',
+                        value: `
+â€¢ **Ã‰coutez** sans juger
+â€¢ **Prenez** les menaces au sÃ©rieux
+â€¢ **Encouragez** Ã  chercher de l'aide
+â€¢ **Accompagnez** si possible
+â€¢ **Restez** en contact rÃ©gulier
+â€¢ **Prenez soin** de vous aussi`,
+                        inline: true
+                    },
+                    {
+                        name: 'ğŸ’¡ **Phrases Aidantes**',
+                        value: `
+âœ… "Je suis lÃ  pour toi"
+âœ… "Tu comptes pour moi"
+âœ… "Veux-tu qu'on en parle ?"
+âœ… "Comment puis-je t'aider ?"
+âŒ Ã‰vitez les jugements/minimisations`,
+                        inline: false
+                    }
+                )
+                .setFooter({ text: 'Votre prÃ©sence et votre Ã©coute font la diffÃ©rence' });
+
+            // Embed final avec message d'espoir
+            const hopeEmbed = new EmbedBuilder()
+                .setColor('#FFD700')
+                .setTitle('ğŸŒŸ **MESSAGE D\'ESPOIR**')
+                .setDescription(`
+**ğŸŒ… Il y a toujours une lueur d'espoir, mÃªme dans les moments les plus sombres.**
+
+**ğŸ’ª Rappels importants :**
+â€¢ Vos sentiments sont temporaires, pas permanents
+â€¢ Demander de l'aide est un signe de force, pas de faiblesse  
+â€¢ Vous avez survÃ©cu Ã  100% de vos mauvais jours jusqu'Ã  prÃ©sent
+â€¢ Chaque jour est une nouvelle opportunitÃ©
+â€¢ Vous mÃ©ritez d'Ãªtre heureux(se) et en paix
+
+**ğŸ¯ Prochaines Ã©tapes suggÃ©rÃ©es :**
+1ï¸âƒ£ Contactez une ligne d'Ã©coute dÃ¨s maintenant si nÃ©cessaire
+2ï¸âƒ£ Parlez Ã  un proche de confiance
+3ï¸âƒ£ Prenez rendez-vous avec un professionnel
+4ï¸âƒ£ CrÃ©ez un ticket "Support" si vous voulez parler Ã  notre Ã©quipe
+
+**ğŸŒˆ Votre histoire n'est pas terminÃ©e. Les plus belles pages restent Ã  Ã©crire.**`)
+                .setImage('https://i.imgur.com/hopeful-banner.png') // Vous pouvez ajouter une image inspirante
+                .setFooter({ 
+                    text: 'ğŸ’ Vous n\'Ãªtes jamais seul(e) â€¢ Cette communautÃ© vous soutient',
+                    iconURL: interaction.guild.iconURL({ dynamic: true })
+                });
+
+            // Boutons d'actions rapides
+            const sosActionsRow = new ActionRowBuilder()
+                .addComponents(
+                    new ButtonBuilder()
+                        .setCustomId('sos_create_support_ticket')
+                        .setLabel('Parler Ã  Notre Ã‰quipe')
+                        .setStyle(ButtonStyle.Success)
+                        .setEmoji('ğŸ’¬'),
+                    new ButtonBuilder()
+                        .setLabel('Suicide Ã‰coute')
+                        .setStyle(ButtonStyle.Link)
+                        .setURL('https://www.suicide-ecoute.fr')
+                        .setEmoji('ğŸ“'),
+                    new ButtonBuilder()
+                        .setLabel('SOS AmitiÃ©')
+                        .setStyle(ButtonStyle.Link)
+                        .setURL('https://www.sos-amitie.org')
+                        .setEmoji('ğŸ¤'),
+                    new ButtonBuilder()
+                        .setLabel('Fil SantÃ© Jeunes')
+                        .setStyle(ButtonStyle.Link)
+                        .setURL('https://www.filsantejeunes.com')
+                        .setEmoji('ğŸ‘¥')
+                );
+
+            await this.safeInteractionReply(interaction, {
+                embeds: [sosMainEmbed, preventionEmbed, resourcesEmbed, supportEmbed, hopeEmbed],
+                components: [sosActionsRow],
+                flags: MessageFlags.Ephemeral
+            });
+
+            // Log pour suivi (de maniÃ¨re anonyme)
+            this.logger.info(`Panel SOS consultÃ© par un utilisateur dans ${interaction.guild.name}`);
+
+        } catch (error) {
+            this.logger.error('Erreur lors de l\'affichage du panel SOS:', error);
+            
+            // Message de fallback simple mais important
+            try {
+                await this.safeInteractionReply(interaction, {
+                    content: `ğŸ†˜ **NUMÃ‰ROS D'URGENCE:**\n\n**France:**\nâ€¢ Suicide Ã‰coute: \`01 45 39 40 00\` (24h/24)\nâ€¢ SOS AmitiÃ©: \`09 72 39 40 50\` (24h/24)\nâ€¢ SAMU: \`15\`\nâ€¢ Urgences: \`112\`\n\n**Vous n'Ãªtes pas seul(e). Il y a toujours de l'espoir.** ğŸ’`,
+                    flags: MessageFlags.Ephemeral
+                });
+            } catch (fallbackError) {
+                this.logger.error('Impossible d\'envoyer le message SOS de fallback:', fallbackError);
+            }
+        }
+    }
+
     // Gestionnaires pour les actions dans les tickets
     async handleTicketAction(interaction) {
         const action = interaction.customId;
-- 
2.45.1.windows.1

